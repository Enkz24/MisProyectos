<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sistema de Integración de Horarios | Parte del Código</title>

  <style>
    :root {
      --bg: #020617;
      --card: #0f172a;
      --accent: #38bdf8;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --code: #020617;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: var(--bg);
      color: var(--text);
    }

    header {
      padding: 3rem 1.5rem 2rem;
      max-width: 1100px;
      margin: auto;
    }

    header h1 {
      font-size: clamp(2rem, 4vw, 3rem);
      margin-bottom: .5rem;
    }

    header p {
      color: var(--muted);
      max-width: 900px;
    }

    main {
      max-width: 1100px;
      margin: auto;
      padding: 0 1.5rem 4rem;
    }

    section { margin-top: 3rem; }

    h2 { color: var(--accent); }

    .block {
      display: grid;
      grid-template-columns: .9fr 1.1fr;
      gap: 1.5rem;
      align-items: start;
    }

    @media (max-width: 900px) {
      .block { grid-template-columns: 1fr; }
    }

    .code-card, .info-card {
      background: linear-gradient(180deg, var(--card), #020617);
      border-radius: 1.2rem;
      padding: 1.5rem;
      box-shadow: 0 20px 40px rgba(0,0,0,.4);
    }

    .code-card {
      max-height: 420px;
      overflow: hidden;
    }

    pre {
      background: var(--code);
      padding: 1rem;
      border-radius: .8rem;
      overflow-x: auto;
      overflow-y: auto;
      max-height: 360px;
      font-size: .82rem;
      line-height: 1.4;
    }

    .info-card p {
      color: var(--muted);
      line-height: 1.6;
    }

    .preview {
      width: 100%;
      height: 260px;
      object-fit: contain;
      background: #020617;
      border-radius: .8rem;
      margin-top: 1rem;
    }

    footer {
      text-align: center;
      padding: 2rem 1rem;
      color: var(--muted);
      font-size: .9rem;
    }

    .title-code {
      display: flex;
      align-items: center;
      gap: .75rem;
      font-size: clamp(1.8rem, 3vw, 2.4rem);
    }

    .title-code svg {
      width: 50px;
      height: 50px;
      color: var(--accent);
      flex-shrink: 0;
    }

    .title-code span {
      color: var(--accent);
      font-weight: 500;
    }
  </style>
</head>
<body>

<header>
  <h1 class="title-code">
    <svg viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2"
         stroke-linecap="round" stroke-linejoin="round">
      <polyline points="16 18 22 12 16 6"></polyline>
      <polyline points="8 6 2 12 8 18"></polyline>
    </svg>
    Sistema de Integración de Horarios <span>| Parte del Código</span>
  </h1>

  <p>
    Fragmentos representativos del proceso ETL desarrollado en Python con Pandas
    para unificar horarios académicos provenientes de múltiples archivos Excel,
    almacenarlos en base de datos y visualizarlos mediante una aplicación web.
  </p>
</header>

<main>

  <!-- ===================== EXTRACT ===================== -->
  <section>
    <h2>Extracción de Horarios desde Excel</h2>
    <div class="block">

      <div class="code-card">
<pre><code>
import pandas as pd

def load_excel(file_path):
    df = pd.read_excel(file_path)
    df.columns = [c.strip().upper() for c in df.columns]

    return df[[
        "CURSO",
        "DOCENTE",
        "DIA",
        "HORA_INICIO",
        "HORA_FIN",
        "AULA"
    ]]
</code></pre>
      </div>

      <div class="info-card">
        <p>
          En esta etapa del ETL se realiza la lectura de archivos Excel
          provenientes de distintas áreas académicas.
          Pandas permite manejar variaciones de formato,
          normalizando nombres de columnas y estructuras.
        </p>
        <img src="assets/previews/excel-horarios.png" class="preview" alt="Excel horarios">
      </div>

    </div>
  </section>

  <!-- ===================== TRANSFORM ===================== -->
  <section>
    <h2>Transformación y Normalización de Datos</h2>
    <div class="block">

      <div class="code-card">
<pre><code>
def transform_data(df):
    df["DIA"] = df["DIA"].str.upper()
    df["HORA_INICIO"] = pd.to_datetime(df["HORA_INICIO"]).dt.strftime("%H:%M")
    df["HORA_FIN"] = pd.to_datetime(df["HORA_FIN"]).dt.strftime("%H:%M")

    df = df.drop_duplicates()
    df = df.dropna(subset=["CURSO", "AULA"])

    return df
</code></pre>
      </div>

      <div class="info-card">
        <p>
          Los datos extraídos son limpiados y transformados:
          se estandarizan días, formatos de hora,
          se eliminan duplicados y registros incompletos.
        </p>
        <p>
          Esta fase asegura coherencia antes de la inserción en la base de datos
          y permite detectar errores en los archivos originales.
        </p>
        <img src="assets/previews/pandas-procesamiento.png" class="preview" alt="Transformación Pandas">
      </div>

    </div>
  </section>

  <!-- ===================== LOAD ===================== -->
  <section>
    <h2>Carga de Horarios en Base de Datos</h2>
    <div class="block">

      <div class="code-card">
<pre><code>
import mysql.connector

def insert_to_db(df, conn):
    cursor = conn.cursor()

    query = """
    INSERT INTO horarios
    (curso, docente, dia, hora_inicio, hora_fin, aula)
    VALUES (%s, %s, %s, %s, %s, %s)
    """

    for _, row in df.iterrows():
        cursor.execute(query, tuple(row))

    conn.commit()
</code></pre>
      </div>

      <div class="info-card">
        <p>
          Una vez normalizados, los horarios se cargan en una base de datos
          relacional, quedando centralizados y disponibles
          para su consumo por otros sistemas.
        </p>
        <p>
          Este enfoque elimina la dependencia directa de archivos Excel
          y permite escalar el sistema.
        </p>
        <img src="assets/previews/db-horarios.png" class="preview" alt="Base de datos">
      </div>

    </div>
  </section>

  <!-- ===================== CONSUMO ===================== -->
  <section>
    <h2>Consumo y Visualización de Horarios</h2>
    <div class="block">

      <div class="code-card">
<pre><code>
// API Node.js
app.get("/api/horarios", async (req, res) => {
  const [rows] = await db.query("SELECT * FROM horarios");
  res.json(rows);
});
</code></pre>
      </div>

      <div class="info-card">
        <p>
          Los datos almacenados son expuestos mediante una API REST
          desarrollada en Node.js.
        </p>
        <p>
          Esta API es consumida por una aplicación web en Next.js
          que permite visualizar horarios por aula, docente o día,
          facilitando la toma de decisiones académicas.
        </p>
        <img src="assets/previews/web-visualizacion.png" class="preview" alt="Visualización web">
      </div>

    </div>
  </section>

</main>

<footer>
  © 2026 – Código parcial | Sistema de Integración y Visualización de Horarios Académicos
</footer>

</body>
</html>
